<% title @channel.channel_name %>
<h1><%= @channel.channel_name %></h1>
<div class="row channel index">
  <div class="col-sm-8">
    <h2 class="section-header h4">
      Related <%= 'Recipient'.pluralize(@channel.recipients.count) %> <span class="text-muted small">(<%= number_with_delimiter(@related_recipients.size) + ' of ' + number_with_delimiter(@related_recipients.total_count) %>)</span>
      <% if current_user.admin %>
        <%= link_to 'Edit Channel',
        edit_channel_path,
        {:class => "btn btn-sm btn-link pull-right"} %>
      <% end %>
    </h2>
    <%= paginate @related_recipients, :theme => 'bootstrap' %>
    <div class="per-page pull-right pagination">
       <%= render 'per_page'%>
    </div>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Recipient</th>
          <th>Multimedia</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @related_recipients.sort_by{|t| t.recipient_name.downcase.sub(/^the |a |an /i,"")}.each do |cr| %>
        <tr>
          <td><%= link_to cr.recipient_name, recipient_path(cr) %></td>
          <td>
            <% cr.multimedia.each do |multi| %>
            <%= link_to(multi) do%>
            <i class="bts <%= multi.icon %>"></i>
            <% end %>
            <% end %>
          </td>
          <td></td>
        </tr>
        <% end %>
      </tbody>
    </table>
    <%= paginate @related_recipients, :theme => 'bootstrap' %>
  </div>
</div>
<hr>
<div class="row">
  <div class="col-sm-2 col-sm-offset-10">
    <%= link_to 'Delete Channel', channel_path, method: :delete, data: { confirm: "Are you sure? This can not be undone."}, :class => "btn btn-danger btn-sm pull-right" %>
  </div>
</div>